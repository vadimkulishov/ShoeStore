{% extends 'shop/base.html' %}

{% block title %}{% if is_edit %}Редактировать{% else %}Добавить{% endif %} заказ - ООО Обувь{% endblock %}

{% block content %}
<h1>{% if is_edit %}Редактировать заказ{% else %}Добавить новый заказ{% endif %}</h1>

<div style="max-width: 600px; margin: 20px 0;">
    <form method="post">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="{{ form.order_number.id_for_label }}">Номер заказа:</label>
            {{ form.order_number }}
            {% if form.order_number.errors %}<span style="color: red;">{{ form.order_number.errors.0 }}</span>{% endif %}
        </div>
        
        <div class="form-group">
            <label for="{{ form.order_date.id_for_label }}">Дата заказа:</label>
            {{ form.order_date }}
            {% if form.order_date.errors %}<span style="color: red;">{{ form.order_date.errors.0 }}</span>{% endif %}
        </div>
        
        <div class="form-group">
            <label for="{{ form.delivery_date.id_for_label }}">Дата доставки:</label>
            {{ form.delivery_date }}
            {% if form.delivery_date.errors %}<span style="color: red;">{{ form.delivery_date.errors.0 }}</span>{% endif %}
        </div>
        
        <div class="form-group">
            <label for="{{ form.delivery_point.id_for_label }}">Адрес пункта выдачи:</label>
            {{ form.delivery_point }}
            {% if form.delivery_point.errors %}<span style="color: red;">{{ form.delivery_point.errors.0 }}</span>{% endif %}
        </div>
        
        <div class="form-group">
            <label for="{{ form.customer_name.id_for_label }}">ФИО клиента:</label>
            {{ form.customer_name }}
            {% if form.customer_name.errors %}<span style="color: red;">{{ form.customer_name.errors.0 }}</span>{% endif %}
        </div>
        
        <div class="form-group">
            <label for="{{ form.code.id_for_label }}">Код для получения:</label>
            {{ form.code }}
            {% if form.code.errors %}<span style="color: red;">{{ form.code.errors.0 }}</span>{% endif %}
        </div>
        
        <div class="form-group">
            <label for="{{ form.status.id_for_label }}">Статус заказа:</label>
            {{ form.status }}
            {% if form.status.errors %}<span style="color: red;">{{ form.status.errors.0 }}</span>{% endif %}
        </div>
        
        <div style="display: flex; gap: 10px; margin-top: 30px;">
            <button type="submit" class="btn btn-primary" style="flex: 1;">
                {% if is_edit %}Сохранить изменения{% else %}Добавить заказ{% endif %}
            </button>
            <a href="{% url 'shop:orders_list' %}" class="btn btn-secondary" style="flex: 1; text-decoration: none; padding: 10px;">Отмена</a>
        </div>
    </form>
    
    {% if is_edit and order %}
    <div style="margin-top: 30px; padding: 15px; background-color: #e8f5e9; border-radius: 4px;">
        <h3 style="margin-bottom: 10px;">Товары в этом заказе:</h3>
        <ul>
            {% for item in order.items.all %}
            <li>
                <strong>{{ item.product.name }}</strong> ({{ item.product.article }})
                <br><span style="color: #666;">Количество: {{ item.quantity }} шт.</span>
            </li>
            {% endfor %}
        </ul>
        <p style="margin-top: 10px; font-size: 12px; color: #666;">
            Для изменения товаров удалите заказ и создайте новый.
        </p>
    </div>
    {% endif %}
</div>
{% endblock %}
